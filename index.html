<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeilãoInvest Pro | Calculadora Avançada</title>
    
    <!-- React e ReactDOM via CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para traduzir o código React no navegador -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS para o design -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Configuração do Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Inter', sans-serif; -webkit-font-smoothing: antialiased; }
        .animate-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        select, input {
            font-size: 0.95rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- 1. ÍCONES ---
        const Icons = {
            Calculator: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>,
            Building2: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></svg>,
            Car: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/></svg>,
            TrendingUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>,
            Hammer: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9"/><path d="M17.64 15 22 10.64"/><path d="m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25V7.86c0-.55-.45-1-1-1H14.14c-.83 0-1.64.32-2.25.92L9.64 10"/><path d="m17.38 5.38 3.12 3.12"/></svg>,
            BarChart3: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></svg>,
            ChevronDown: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m6 9 6 6 6-6"/></svg>,
            Clock: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            Info: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
        };

        // --- 2. COMPONENTES VISUAIS ---
        
        const SectionHeader = ({ title, icon: Icon }) => (
            <div className="flex items-center gap-2 mb-4 pb-2 border-b border-gray-200 text-gray-800">
                {Icon && <span className="text-indigo-600"><Icon /></span>}
                <h3 className="font-bold text-lg">{title}</h3>
            </div>
        );

        const InputGroup = ({ label, id, children, required, subtext }) => (
            <div className="flex flex-col gap-1">
                <label htmlFor={id} className="text-sm font-medium text-gray-700 flex justify-between items-end h-5">
                    <span>{label} {required && <span className="text-red-500">*</span>}</span>
                </label>
                {children}
                <span className="text-xs text-gray-500 h-4 block truncate">{subtext || ''}</span>
            </div>
        );

        // Componente de Input com Máscara de Moeda (ATM Style)
        const CurrencyInput = ({ value, onChange, name, placeholder, readOnly = false, className = "" }) => {
            const floatToBRL = (val) => {
                if (val === '' || val === undefined || val === null) return '';
                return Number(val).toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            };

            const stringToFloat = (str) => {
                const digits = str.replace(/\D/g, "");
                return digits ? (Number(digits) / 100) : '';
            };

            const [displayValue, setDisplayValue] = useState(floatToBRL(value));

            useEffect(() => {
                setDisplayValue(floatToBRL(value));
            }, [value]);

            const handleChange = (e) => {
                const rawValue = e.target.value;
                const newValue = stringToFloat(rawValue);
                setDisplayValue(floatToBRL(newValue));
                onChange({
                    target: {
                        name: name,
                        value: newValue,
                        type: 'currency'
                    }
                });
            };

            return (
                <div className="relative">
                    <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <span className="text-gray-500 sm:text-sm">R$</span>
                    </div>
                    <input
                        type="text"
                        name={name}
                        value={displayValue}
                        onChange={handleChange}
                        placeholder={placeholder || "0,00"}
                        readOnly={readOnly}
                        className={`block w-full pl-10 pr-3 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md border ${readOnly ? 'bg-gray-100 text-gray-500' : 'bg-white'} ${className}`}
                        inputMode="numeric"
                    />
                </div>
            );
        };

        // --- 3. APLICAÇÃO PRINCIPAL ---
        const App = () => {
            const [activeTab, setActiveTab] = useState('imoveis');
            
            const [imovelData, setImovelData] = useState({
                endereco: '',
                tipo: 'apartamento',
                metragem: '',
                quartos: '',
                banheiros: '',
                vagas: '',
                conservacao: 'bom',
                documentacao: 'regular',
                tipoLeilao: 'extrajudicial',
                ocupacao: 'livre',
                valorAvaliacao: '',
                valorMercado: '',
                tempoVenda: 6,
                demanda: 'media',
                estrategia: 'venda',
                valorAluguel: '',
                lancePretendido: '',
                taxaItbi: 3.0,
                registroCartorio: 2850,
                advogado: 1900,
                certidoesDocumentos: 500,
                vistoriaTecnica: 800,
                seguroGarantia: 950,
                iptuMensal: '',
                condominioMensal: '',
                outrosCustos: '',
                necessitaReforma: false,
                tipoReforma: 'basica',
                custoM2: 200,
                tempoReforma: 3,
                usarFinanciamento: false,
                entradaPercent: 20,
                taxaJuros: 10.5,
                prazoFinanciamento: 20,
                corretagemPercent: 6, // Editável
                publicidade: 2000,
                tipoPessoa: 'pf'
            });

            const [veiculoData, setVeiculoData] = useState({
                marcaModelo: '',
                anoFabricacao: '',
                anoModelo: '',
                combustivel: 'flex',
                quilometragem: '',
                cor: '',
                conservacao: 'bom',
                documentacao: 'regular',
                tipoLeilao: 'extrajudicial',
                valorFipe: '',
                lanceMinimo: '',
                valorMercado: '',
                tempoVenda: 3,
                estrategia: 'venda',
                valorAluguel: '',
                lancePretendido: '',
                necessitaReparo: false,
                tipoReparo: 'basico',
                custoReparo: 2000,
                tempoReparo: 15,
                despesaAdministrativa: 1700,
                taxaTransferencia: 400,
                vistoriaDocumentos: 500,
                despachante: 0,
                outrosCustos: 0,
                usarFinanciamento: false,
                entradaPercent: 30,
                taxaJuros: 18.0,
                prazoFinanciamento: 5,
                corretagemPercent: 3, // Editável
                publicidade: 800,
                tipoPessoa: 'pf'
            });

            const handleImovelChange = (e) => {
                const { name, value, type, checked } = e.target;
                setImovelData(prev => ({
                    ...prev,
                    [name]: type === 'checkbox' ? checked : (type === 'number' && value !== '' ? parseFloat(value) : value)
                }));
            };

            const handleVeiculoChange = (e) => {
                const { name, value, type, checked } = e.target;
                setVeiculoData(prev => ({
                    ...prev,
                    [name]: type === 'checkbox' ? checked : (type === 'number' && value !== '' ? parseFloat(value) : value)
                }));
            };

            const formatCurrency = (value) => {
                if (!value && value !== 0) return 'R$ 0,00';
                return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);
            };

            const parseNum = (val) => Number(val) || 0;

            const calculateFinancing = (principal, entryPercent, rateYear, years) => {
                const entry = (principal * entryPercent) / 100;
                const financed = principal - entry;
                const rateMonth = (rateYear / 100) / 12;
                const months = years * 12;
                let payment = 0;
                if (rateMonth > 0 && months > 0) {
                    payment = financed * (rateMonth * Math.pow(1 + rateMonth, months)) / (Math.pow(1 + rateMonth, months) - 1);
                }
                return { entry, financed, payment };
            };

            const imovelResults = useMemo(() => {
                const d = imovelData;
                const lance = parseNum(d.lancePretendido);
                
                const comissaoLeiloeiro = lance * 0.05; // FIX: Nome da variável corrigido
                const itbi = lance * (d.taxaItbi / 100);
                const outrosCustosAquisicao = parseNum(d.outrosCustos); 
                const totalTaxasAquisicao = comissaoLeiloeiro + itbi + parseNum(d.registroCartorio) + parseNum(d.certidoesDocumentos) + parseNum(d.advogado) + parseNum(d.vistoriaTecnica) + parseNum(d.seguroGarantia);
                
                let custoReforma = 0;
                if (d.necessitaReforma) {
                    const fator = d.tipoReforma === 'basica' ? 1 : d.tipoReforma === 'intermediaria' ? 1.3 : 1.6;
                    custoReforma = parseNum(d.metragem) * parseNum(d.custoM2) * fator;
                }

                const baseCustoFiscal = lance + totalTaxasAquisicao + custoReforma + outrosCustosAquisicao;
                const manutencaoMensal = parseNum(d.iptuMensal) + parseNum(d.condominioMensal);
                const custoManutencaoTotal = manutencaoMensal * parseNum(d.tempoVenda);

                let investimentoInicial = baseCustoFiscal;
                let prestacao = 0;
                let saldoDevedor = 0;

                if (d.usarFinanciamento) {
                    const fin = calculateFinancing(lance, d.entradaPercent, d.taxaJuros, d.prazoFinanciamento);
                    investimentoInicial = fin.entry + totalTaxasAquisicao + custoReforma + outrosCustosAquisicao;
                    prestacao = fin.payment;
                    const taxaMensal = (d.taxaJuros / 100) / 12;
                    saldoDevedor = fin.financed;
                    for (let i = 0; i < d.tempoVenda; i++) {
                        saldoDevedor = saldoDevedor * (1 + taxaMensal) - prestacao;
                    }
                }

                const valorVendaEstimado = parseNum(d.valorMercado);
                const valorCorretagem = valorVendaEstimado * (d.corretagemPercent / 100);
                const valorPublicidade = parseNum(d.publicidade);
                
                let lucroLiquido = 0;
                let roi = 0;
                let impostoGanhoCapital = 0;
                let ganhoCapitalBruto = 0;
                
                if (d.estrategia === 'venda') {
                    const valorVendaLiquidoDeComissao = valorVendaEstimado - valorCorretagem; 
                    ganhoCapitalBruto = valorVendaLiquidoDeComissao - baseCustoFiscal;
                    impostoGanhoCapital = ganhoCapitalBruto > 0 ? ganhoCapitalBruto * 0.15 : 0;
                    
                    const recebidoLiquidoVenda = valorVendaEstimado - valorCorretagem - valorPublicidade - impostoGanhoCapital - (d.usarFinanciamento ? saldoDevedor : 0);
                    const totalInvestidoDoBolso = investimentoInicial + custoManutencaoTotal + (d.usarFinanciamento ? (prestacao * d.tempoVenda) : 0);
                    
                    lucroLiquido = recebidoLiquidoVenda - totalInvestidoDoBolso;
                    roi = totalInvestidoDoBolso > 0 ? (lucroLiquido / totalInvestidoDoBolso) * 100 : 0;
                } else {
                    const rendaAnual = parseNum(d.valorAluguel) * 12;
                    lucroLiquido = rendaAnual - (d.usarFinanciamento ? (prestacao * 12) : 0);
                    roi = investimentoInicial > 0 ? (lucroLiquido / investimentoInicial) * 100 : 0;
                }

                let classificacao = 'Inviável';
                let corClassificacao = 'text-red-600 bg-red-100';
                if (roi > 50) { classificacao = 'Excelente'; corClassificacao = 'text-green-700 bg-green-100'; }
                else if (roi > 30) { classificacao = 'Muito Bom'; corClassificacao = 'text-emerald-600 bg-emerald-100'; }
                else if (roi > 15) { classificacao = 'Bom'; corClassificacao = 'text-blue-600 bg-blue-100'; }
                else if (roi > 0) { classificacao = 'Atenção'; corClassificacao = 'text-yellow-600 bg-yellow-100'; }

                return {
                    baseCustoFiscal,
                    valorVendaEstimado,
                    valorCorretagem,
                    ganhoCapitalBruto,
                    impostoGanhoCapital,
                    investimentoInicial,
                    custoManutencaoTotal,
                    lucroLiquido,
                    roi,
                    classificacao,
                    corClassificacao,
                    custosVendaTotal: valorCorretagem + valorPublicidade,
                    tempoTotal: parseNum(d.tempoVenda) + parseNum(d.tempoReforma)
                };
            }, [imovelData]);

            const veiculoResults = useMemo(() => {
                const d = veiculoData;
                const lance = parseNum(d.lancePretendido);
                const comissao = lance * 0.05;
                const totalArrematacao = comissao + parseNum(d.despesaAdministrativa) + parseNum(d.taxaTransferencia) + parseNum(d.vistoriaDocumentos) + parseNum(d.despachante);
                let custoReparo = d.necessitaReparo ? parseNum(d.custoReparo) : 0;
                const outrosCustos = parseNum(d.outrosCustos);
                let investimentoInicial = lance + totalArrematacao + custoReparo + outrosCustos;
                let prestacao = 0;
                let saldoDevedor = 0;

                if (d.usarFinanciamento) {
                    const fin = calculateFinancing(lance, d.entradaPercent, d.taxaJuros, d.prazoFinanciamento);
                    investimentoInicial = fin.entry + totalArrematacao + custoReparo + outrosCustos;
                    prestacao = fin.payment;
                    const taxaMensal = (d.taxaJuros / 100) / 12;
                    saldoDevedor = fin.financed;
                    for (let i = 0; i < d.tempoVenda; i++) {
                        saldoDevedor = saldoDevedor * (1 + taxaMensal) - prestacao;
                    }
                }

                const valorVendaEstimado = parseNum(d.valorMercado) * 0.95;
                const valorCorretagem = valorVendaEstimado * (d.corretagemPercent / 100);
                const valorPublicidade = parseNum(d.publicidade);
                
                let lucroLiquido = 0;
                let roi = 0;
                let impostoGanhoCapital = 0;
                let ganhoCapitalBruto = 0;

                if (d.estrategia === 'venda') {
                    const baseCustoFiscal = lance + totalArrematacao + custoReparo + outrosCustos;
                    const valorVendaLiquido = valorVendaEstimado - valorCorretagem;
                    ganhoCapitalBruto = valorVendaLiquido - baseCustoFiscal;
                    
                    impostoGanhoCapital = ganhoCapitalBruto > 0 ? ganhoCapitalBruto * 0.15 : 0;

                    const recebidoLiquido = valorVendaEstimado - valorCorretagem - valorPublicidade - impostoGanhoCapital - (d.usarFinanciamento ? saldoDevedor : 0);
                    const parcelasPagas = d.usarFinanciamento ? (prestacao * d.tempoVenda) : 0;
                    
                    lucroLiquido = recebidoLiquido - investimentoInicial - parcelasPagas;
                    const capitalInvestido = investimentoInicial + parcelasPagas;
                    roi = capitalInvestido > 0 ? (lucroLiquido / capitalInvestido) * 100 : 0;
                } else {
                    const rendaAnual = parseNum(d.valorAluguel) * 12;
                    lucroLiquido = rendaAnual;
                    roi = investimentoInicial > 0 ? (rendaAnual / investimentoInicial) * 100 : 0;
                }

                let classificacao = 'Inviável';
                let corClassificacao = 'text-red-600 bg-red-100';
                if (roi > 40) { classificacao = 'Excelente'; corClassificacao = 'text-green-700 bg-green-100'; }
                else if (roi > 20) { classificacao = 'Muito Bom'; corClassificacao = 'text-emerald-600 bg-emerald-100'; }
                else if (roi > 10) { classificacao = 'Bom'; corClassificacao = 'text-blue-600 bg-blue-100'; }
                else if (roi > 0) { classificacao = 'Atenção'; corClassificacao = 'text-yellow-600 bg-yellow-100'; }

                return {
                    baseCustoFiscal: lance + totalArrematacao + custoReparo + outrosCustos,
                    valorVendaEstimado,
                    valorCorretagem,
                    ganhoCapitalBruto,
                    impostoGanhoCapital,
                    investimentoInicial,
                    lucroLiquido,
                    roi,
                    classificacao,
                    corClassificacao,
                    custosVendaTotal: valorCorretagem + valorPublicidade,
                    tempoTotal: (parseNum(d.tempoReparo)/30) + parseNum(d.tempoVenda)
                };
            }, [veiculoData]);

            const renderImoveisForm = () => (
                <div className="space-y-8 animate-in">
                    <section className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                        <SectionHeader title="Dados do Imóvel" icon={Icons.Building2} />
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <InputGroup label="Endereço" id="endereco">
                                <input type="text" name="endereco" value={imovelData.endereco} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11" placeholder="Logradouro, Bairro..." />
                            </InputGroup>
                            <InputGroup label="Tipo" id="tipo">
                                <select name="tipo" value={imovelData.tipo} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11 bg-white">
                                    <option value="apartamento">Apartamento</option>
                                    <option value="casa">Casa</option>
                                    <option value="comercial">Comercial</option>
                                    <option value="terreno">Terreno</option>
                                </select>
                            </InputGroup>
                            <div className="grid grid-cols-2 gap-4">
                                <InputGroup label="Área (m²)" id="metragem">
                                    <input type="number" name="metragem" value={imovelData.metragem} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11" />
                                </InputGroup>
                                <InputGroup label="Quartos" id="quartos">
                                    <input type="number" name="quartos" value={imovelData.quartos} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11" />
                                </InputGroup>
                            </div>
                            <InputGroup label="Conservação" id="conservacao">
                                <select name="conservacao" value={imovelData.conservacao} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11 bg-white">
                                    <option value="excelente">Excelente</option>
                                    <option value="bom">Bom</option>
                                    <option value="regular">Regular</option>
                                    <option value="ruim">Ruim</option>
                                </select>
                            </InputGroup>
                            <InputGroup label="Valor Avaliação" id="valorAvaliacao">
                                <CurrencyInput name="valorAvaliacao" value={imovelData.valorAvaliacao} onChange={handleImovelChange} className="h-11" />
                            </InputGroup>
                        </div>
                    </section>

                    <section className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                        <SectionHeader title="Valores e Estratégia" icon={Icons.TrendingUp} />
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <InputGroup label="Valor de Mercado" id="valorMercado" required>
                                <CurrencyInput name="valorMercado" value={imovelData.valorMercado} onChange={handleImovelChange} className="h-11" />
                            </InputGroup>
                            
                            <div className="p-4 bg-indigo-50 rounded-lg border border-indigo-100 col-span-1 md:col-span-2 lg:col-span-2">
                                <InputGroup label="SEU LANCE MÁXIMO PRETENDIDO" id="lancePretendido" required>
                                    <CurrencyInput name="lancePretendido" value={imovelData.lancePretendido} onChange={handleImovelChange} className="h-11" />
                                </InputGroup>
                                <div className="flex gap-4 mt-2 text-xs text-indigo-700">
                                    <span>Desconto Mercado: {imovelData.valorMercado && imovelData.lancePretendido ? ((imovelData.valorMercado - imovelData.lancePretendido)/imovelData.valorMercado * 100).toFixed(1) + '%' : '0%'}</span>
                                    <span>Margem Bruta: {imovelData.valorMercado && imovelData.lancePretendido ? (imovelData.valorMercado - imovelData.lancePretendido).toLocaleString('pt-BR', {style: 'currency', currency: 'BRL'}) : 'R$ 0'}</span>
                                </div>
                            </div>

                            <div className="grid grid-cols-2 gap-4 items-start">
                                <InputGroup label="Estratégia" id="estrategia" subtext="Defina o objetivo">
                                    <select name="estrategia" value={imovelData.estrategia} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11 bg-white">
                                        <option value="venda">Revenda</option>
                                        <option value="aluguel">Aluguel</option>
                                    </select>
                                </InputGroup>
                                <InputGroup label="Prazo Venda (Meses)" id="tempoVenda" subtext="Afeta custos mensais">
                                    <input type="number" name="tempoVenda" value={imovelData.tempoVenda} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11" />
                                </InputGroup>
                            </div>

                            {imovelData.estrategia === 'aluguel' && (
                                <InputGroup label="Valor Aluguel Mensal" id="valorAluguel">
                                    <CurrencyInput name="valorAluguel" value={imovelData.valorAluguel} onChange={handleImovelChange} className="h-11" />
                                </InputGroup>
                            )}

                            <div className="col-span-full border-t border-gray-100 pt-4 mt-2">
                                <label className="flex items-center gap-2 cursor-pointer mb-4">
                                    <input type="checkbox" name="necessitaReforma" checked={imovelData.necessitaReforma} onChange={handleImovelChange} className="w-4 h-4 text-indigo-600 rounded" />
                                    <span className="font-medium text-gray-700">Necessita Reforma?</span>
                                </label>
                                
                                {imovelData.necessitaReforma && (
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 bg-gray-50 p-4 rounded-lg">
                                        <InputGroup label="Nível">
                                            <select name="tipoReforma" value={imovelData.tipoReforma} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md p-2 border h-11 bg-white">
                                                <option value="basica">Básica (Pintura)</option>
                                                <option value="intermediaria">Média (Pisos)</option>
                                                <option value="completa">Completa</option>
                                            </select>
                                        </InputGroup>
                                        <InputGroup label="Custo Est. (R$/m²)">
                                            <CurrencyInput name="custoM2" value={imovelData.custoM2} onChange={handleImovelChange} className="h-11" />
                                        </InputGroup>
                                        <InputGroup label="Duração (meses)">
                                            <input type="number" name="tempoReforma" value={imovelData.tempoReforma} onChange={handleImovelChange} className="w-full border-gray-300 rounded-md p-2 border h-11" />
                                        </InputGroup>
                                    </div>
                                )}
                            </div>
                        </div>
                    </section>

                    <section className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                        <SectionHeader title="Manutenção Pós-Posse (Mensal)" icon={Icons.Clock} />
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <InputGroup label="Condomínio Mensal" subtext="Valor cheio sem desconto">
                                <CurrencyInput name="condominioMensal" value={imovelData.condominioMensal} onChange={handleImovelChange} className="h-11" />
                            </InputGroup>
                            <InputGroup label="IPTU Mensal" subtext="Parcela mensal">
                                <CurrencyInput name="iptuMensal" value={imovelData.iptuMensal} onChange={handleImovelChange} className="h-11" />
                            </InputGroup>
                            <div className="bg-yellow-50 p-3 rounded border border-yellow-100">
                                <p className="text-xs text-yellow-800 font-bold">Custo Total no Período:</p>
                                <p className="text-lg font-bold text-yellow-900">
                                    {formatCurrency((parseNum(imovelData.condominioMensal) + parseNum(imovelData.iptuMensal)) * parseNum(imovelData.tempoVenda))}
                                </p>
                                <p className="text-xs text-yellow-600">Considerando {imovelData.tempoVenda} meses de venda.</p>
                            </div>
                        </div>
                    </section>

                    <section className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                        <details className="group">
                            <summary className="flex cursor-pointer items-center justify-between font-medium text-gray-900 list-none">
                                <SectionHeader title="Custos Detalhados (Editáveis)" icon={Icons.Calculator} />
                                <span className="transition group-open:rotate-180"><Icons.ChevronDown /></span>
                            </summary>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-4 animate-in">
                                <InputGroup label="ITBI (%)">
                                    <input type="number" name="taxaItbi" value={imovelData.taxaItbi} onChange={handleImovelChange} className="w-full border p-2 rounded h-11" />
                                </InputGroup>
                                <InputGroup label="Registro (R$)">
                                    <CurrencyInput name="registroCartorio" value={imovelData.registroCartorio} onChange={handleImovelChange} className="h-11" />
                                </InputGroup>
                                <InputGroup label="Advogado Desocupação (R$)">
                                    <CurrencyInput name="advogado" value={imovelData.advogado} onChange={handleImovelChange} className="h-11" />
                                </InputGroup>
                                <InputGroup label="Outros Custos Extras">
                                    <CurrencyInput name="outrosCustos" value={imovelData.outrosCustos} onChange={handleImovelChange} placeholder="Valor Total" className="h-11" />
                                </InputGroup>
                                <InputGroup label="Comissão Corretor (%)">
                                    <input type="number" name="corretagemPercent" value={imovelData.corretagemPercent} onChange={handleImovelChange} className="w-full border p-2 rounded h-11" />
                                </InputGroup>
                            </div>
                        </details>
                    </section>

                    <section className="bg-slate-900 text-white p-6 rounded-xl shadow-lg mt-8">
                        <div className="flex items-center gap-3 mb-6">
                            <span className="text-emerald-400"><Icons.BarChart3 /></span>
                            <h2 className="text-xl font-bold">Resultado Financeiro</h2>
                            <span className={`ml-auto px-4 py-1 rounded-full text-sm font-bold uppercase tracking-wider ${imovelResults.corClassificacao}`}>
                                {imovelResults.classificacao}
                            </span>
                        </div>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">Investimento Inicial</p>
                                <p className="text-2xl font-bold text-white">{formatCurrency(imovelResults.investimentoInicial)}</p>
                            </div>
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">Lucro Líquido Final</p>
                                <p className={`text-2xl font-bold ${imovelResults.lucroLiquido > 0 ? 'text-emerald-400' : 'text-red-400'}`}>
                                    {formatCurrency(imovelResults.lucroLiquido)}
                                </p>
                            </div>
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">ROI (Retorno)</p>
                                <p className={`text-2xl font-bold ${imovelResults.roi > 15 ? 'text-emerald-400' : 'text-yellow-400'}`}>
                                    {imovelResults.roi.toFixed(2)}%
                                </p>
                            </div>
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">Imposto Ganho Capital (15%)</p>
                                <p className="text-2xl font-bold text-red-300">{formatCurrency(imovelResults.impostoGanhoCapital)}</p>
                            </div>
                        </div>

                        {/* Nova Seção de Detalhamento do Imposto */}
                        {imovelData.estrategia === 'venda' && (
                            <div className="bg-slate-800 p-6 rounded-xl border border-slate-700 mb-6">
                                <div className="flex items-center gap-2 mb-4 text-emerald-400">
                                    <Icons.Info />
                                    <h3 className="font-bold">Entenda o Cálculo do Imposto (15%)</h3>
                                </div>
                                <div className="space-y-2 text-sm text-slate-300">
                                    <div className="flex justify-between border-b border-slate-700 pb-1">
                                        <span>Valor de Venda</span>
                                        <span>{formatCurrency(imovelResults.valorVendaEstimado)}</span>
                                    </div>
                                    <div className="flex justify-between text-red-300">
                                        <span>(-) Custo de Aquisição & Benfeitorias</span>
                                        <span>- {formatCurrency(imovelResults.baseCustoFiscal)}</span>
                                    </div>
                                    <div className="pl-4 text-xs text-slate-400">
                                        <div className="flex justify-between">
                                            <span>(Lance + Taxas + Reforma + Outros)</span>
                                        </div>
                                    </div>
                                    <div className="flex justify-between text-red-300">
                                        <span>(-) Corretagem (Dedutível)</span>
                                        <span>- {formatCurrency(imovelResults.valorCorretagem)}</span>
                                    </div>
                                    <div className="flex justify-between border-t border-slate-600 pt-1 font-bold text-white">
                                        <span>(=) Lucro Tributável (Base de Cálculo)</span>
                                        <span>{formatCurrency(imovelResults.ganhoCapitalBruto)}</span>
                                    </div>
                                    <div className="flex justify-between pt-1 text-red-400 font-bold">
                                        <span>(x) Alíquota 15% (A Pagar)</span>
                                        <span>{formatCurrency(imovelResults.impostoGanhoCapital)}</span>
                                    </div>
                                    <p className="text-xs text-slate-500 mt-2 italic">* Custos de manutenção (Condomínio/IPTU) reduzem seu lucro líquido, mas não abatem do Imposto de Renda.</p>
                                </div>
                            </div>
                        )}

                        <div className="border-t border-slate-700 pt-4 text-sm text-slate-300 grid grid-cols-2 gap-4">
                            <div>
                                <span className="block text-slate-500">Custos Manutenção ({imovelData.tempoVenda} meses):</span>
                                <span className="font-semibold text-red-300">- {formatCurrency(imovelResults.custoManutencaoTotal)}</span>
                            </div>
                            <div>
                                <span className="block text-slate-500">Despesas Venda (Corretagem + MKT):</span>
                                <span className="font-semibold text-red-300">- {formatCurrency(imovelResults.custosVendaTotal)}</span>
                            </div>
                        </div>
                    </section>
                </div>
            );

            const renderVeiculosForm = () => (
                <div className="space-y-8 animate-in">
                    <section className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                        <SectionHeader title="Dados do Veículo" icon={Icons.Car} />
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <InputGroup label="Marca/Modelo" id="marcaModelo">
                                <input type="text" name="marcaModelo" value={veiculoData.marcaModelo} onChange={handleVeiculoChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11" placeholder="Ex: Honda Civic..." />
                            </InputGroup>
                            <div className="grid grid-cols-2 gap-4">
                                <InputGroup label="Ano Fab." id="anoFabricacao">
                                    <input type="number" name="anoFabricacao" value={veiculoData.anoFabricacao} onChange={handleVeiculoChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11" />
                                </InputGroup>
                                <InputGroup label="KM" id="quilometragem">
                                    <input type="number" name="quilometragem" value={veiculoData.quilometragem} onChange={handleVeiculoChange} className="w-full border-gray-300 rounded-md shadow-sm p-2 border h-11" />
                                </InputGroup>
                            </div>
                            <InputGroup label="Tabela FIPE" id="valorFipe">
                                <CurrencyInput name="valorFipe" value={veiculoData.valorFipe} onChange={handleVeiculoChange} className="h-11" />
                            </InputGroup>
                            <InputGroup label="Valor de Revenda Real" id="valorMercado" required subtext="Pesquise na WebMotors/OLX">
                                <CurrencyInput name="valorMercado" value={veiculoData.valorMercado} onChange={handleVeiculoChange} className="h-11" />
                            </InputGroup>
                            
                            <div className="p-4 bg-indigo-50 rounded-lg border border-indigo-100 col-span-1 md:col-span-2 lg:col-span-2">
                                <InputGroup label="LANCE MÁXIMO (TETO)" id="lancePretendido" required>
                                    <CurrencyInput name="lancePretendido" value={veiculoData.lancePretendido} onChange={handleVeiculoChange} className="h-11" />
                                </InputGroup>
                                <div className="flex gap-4 mt-2 text-xs text-indigo-700">
                                    <span>Desconto FIPE: {veiculoData.valorFipe && veiculoData.lancePretendido ? ((veiculoData.valorFipe - veiculoData.lancePretendido)/veiculoData.valorFipe * 100).toFixed(1) + '%' : '0%'}</span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section className="bg-white p-6 rounded-xl border border-gray-200 shadow-sm">
                        <SectionHeader title="Custos e Reparos" icon={Icons.Hammer} />
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div className="col-span-full mb-2">
                                <label className="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" name="necessitaReparo" checked={veiculoData.necessitaReparo} onChange={handleVeiculoChange} className="w-4 h-4 text-indigo-600 rounded" />
                                    <span className="font-medium text-gray-700">Necessita Mecânica/Funilaria?</span>
                                </label>
                            </div>
                            {veiculoData.necessitaReparo && (
                                <>
                                    <InputGroup label="Custo Estimado">
                                        <CurrencyInput name="custoReparo" value={veiculoData.custoReparo} onChange={handleVeiculoChange} className="h-11" />
                                    </InputGroup>
                                    <InputGroup label="Tempo Parado (dias)">
                                        <input type="number" name="tempoReparo" value={veiculoData.tempoReparo} onChange={handleVeiculoChange} className="w-full border p-2 rounded h-11" />
                                    </InputGroup>
                                </>
                            )}
                            <InputGroup label="Despesas Pátio/Admin">
                                <CurrencyInput name="despesaAdministrativa" value={veiculoData.despesaAdministrativa} onChange={handleVeiculoChange} className="h-11" />
                            </InputGroup>
                            <InputGroup label="Outros Custos">
                                <CurrencyInput name="outrosCustos" value={veiculoData.outrosCustos} onChange={handleVeiculoChange} className="h-11" />
                            </InputGroup>
                            <InputGroup label="Comissão Corretor (%)">
                                <input type="number" name="corretagemPercent" value={veiculoData.corretagemPercent} onChange={handleVeiculoChange} className="w-full border p-2 rounded h-11" />
                            </InputGroup>
                        </div>
                    </section>

                    <section className="bg-slate-900 text-white p-6 rounded-xl shadow-lg mt-8">
                        <div className="flex items-center gap-3 mb-6">
                            <span className="text-emerald-400"><Icons.BarChart3 /></span>
                            <h2 className="text-xl font-bold">Viabilidade do Veículo</h2>
                            <span className={`ml-auto px-4 py-1 rounded-full text-sm font-bold uppercase tracking-wider ${veiculoResults.corClassificacao}`}>
                                {veiculoResults.classificacao}
                            </span>
                        </div>
                        
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">Custo Total</p>
                                <p className="text-2xl font-bold text-white">{formatCurrency(veiculoResults.investimentoInicial)}</p>
                            </div>
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">Lucro Líquido</p>
                                <p className={`text-2xl font-bold ${veiculoResults.lucroLiquido > 0 ? 'text-emerald-400' : 'text-red-400'}`}>
                                    {formatCurrency(veiculoResults.lucroLiquido)}
                                </p>
                            </div>
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">ROI</p>
                                <p className={`text-2xl font-bold ${veiculoResults.roi > 15 ? 'text-emerald-400' : 'text-yellow-400'}`}>
                                    {veiculoResults.roi.toFixed(2)}%
                                </p>
                            </div>
                            <div className="bg-slate-800 p-4 rounded-lg">
                                <p className="text-slate-400 text-sm mb-1">Imposto (15%)</p>
                                <p className="text-2xl font-bold text-red-300">{formatCurrency(veiculoResults.impostoGanhoCapital)}</p>
                            </div>
                        </div>
                    </section>
                </div>
            );

            return (
                <div className="min-h-screen pb-20">
                    <header className="bg-white border-b border-gray-200 sticky top-0 z-10 shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
                            <div className="flex items-center gap-3">
                                <div className="bg-indigo-600 text-white p-2 rounded-lg">
                                    <Icons.Calculator />
                                </div>
                                <div>
                                    <h1 className="text-xl font-bold text-gray-900 tracking-tight">LeilãoInvest <span className="text-indigo-600">Pro</span></h1>
                                    <p className="text-xs text-gray-500 font-medium">Análise de Viabilidade</p>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        <div className="flex justify-center mb-8">
                            <div className="bg-white p-1 rounded-xl shadow-sm border border-gray-200 inline-flex">
                                <button
                                    onClick={() => setActiveTab('imoveis')}
                                    className={`flex items-center gap-2 px-6 py-3 rounded-lg text-sm font-semibold transition-all ${
                                        activeTab === 'imoveis' 
                                        ? 'bg-indigo-600 text-white shadow-md transform scale-105' 
                                        : 'text-gray-500 hover:text-gray-900 hover:bg-gray-50'
                                    }`}
                                >
                                    <Icons.Building2 /> Imóveis
                                </button>
                                <button
                                    onClick={() => setActiveTab('veiculos')}
                                    className={`flex items-center gap-2 px-6 py-3 rounded-lg text-sm font-semibold transition-all ${
                                        activeTab === 'veiculos' 
                                        ? 'bg-indigo-600 text-white shadow-md transform scale-105' 
                                        : 'text-gray-500 hover:text-gray-900 hover:bg-gray-50'
                                    }`}
                                >
                                    <Icons.Car /> Veículos
                                </button>
                            </div>
                        </div>

                        {activeTab === 'imoveis' ? renderImoveisForm() : renderVeiculosForm()}
                    </main>
                    
                    <footer className="text-center text-gray-400 text-sm py-8 border-t border-gray-200 mt-8">
                        <p>© {new Date().getFullYear()} LeilãoInvest Pro. Todos os direitos reservados.</p>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
